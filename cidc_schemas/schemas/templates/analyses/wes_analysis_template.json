{
    "title": "WES analysis template",
    "description": "Metadata information for WES Analysis output.",
    "prism_template_root_object_schema": "assays/components/ngs/wes/wes_analysis.json",
    "prism_template_root_object_pointer": "/analysis/wes_analysis",
    "properties": {
        "worksheets": {

            "WES Analysis": {
                "preamble_rows": {
                    "protocol identifier": {
                        "merge_pointer": "2/protocol_identifier",
                        "type_ref": "clinical_trial.json#properties/protocol_identifier"
                    }
                },
                "prism_data_object_pointer": "/pair_runs/-",
                "data_columns": {
                    "WES Runs": {
                        "run id": {
                            "merge_pointer": "/run_id",
                            "type_ref": "assays/components/ngs/wes/wes_pair_analysis.json#properties/run_id",
                            "process_as": [
                                {
                                    "parse_through": "lambda run: f'analysis/clonality/{run}/{run}_pyclone.tsv'",
                                    "merge_pointer": "/clonality/clonality_pyclone",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/clonality_pyclone.tsv",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/copynumber/{run}/{run}_cnvcalls.txt'",
                                    "merge_pointer": "/copynumber/copynumber_cnv_calls",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/copynumber_cnvcalls.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/copynumber/{run}/{run}_cnvcalls.txt.tn.tsv'",
                                    "merge_pointer": "/copynumber/copynumber_cnv_calls_tsv",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/copynumber_cnvcalls.txt.tn.tsv",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/somatic/{run}/{run}_tnscope.filter.vcf.gz'",
                                    "merge_pointer": "/somatic/vcf_gz_tnscope_filter",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/vcf_gz_tnscope_filter.vcf.gz",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/somatic/{run}/{run}_tnscope.output.vcf.gz'",
                                    "merge_pointer": "/somatic/vcf_gz_tnscope_output",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/vcf_gz_tnscope_output.vcf.gz",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/all_sample_summaries.txt'",
                                    "merge_pointer": "/tumor/metrics/all_summaries",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/all_summaries.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/report/wes_version.txt'",
                                    "merge_pointer": "/report/wes_version",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/wes_version.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/report/config.yaml'",
                                    "merge_pointer": "/report/config",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/config.yaml",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/report/wes_meta/02_wes_run_version.tsv'",
                                    "merge_pointer": "/report/wes_run_version",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/wes_run_version.tsv",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/report/metasheet.csv'",
                                    "merge_pointer": "/report/metasheet",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/metasheet.csv",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/report/report.zip'",
                                    "merge_pointer": "/report/report",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/report.zip",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/report2/somatic_variants/tumor_mutational_burden.tsv'",
                                    "merge_pointer": "/report/tumor_mutational_burden",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/tumor_mutational_burden.tsv",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/report2/neoantigen/HLA_results.tsv'",
                                    "merge_pointer": "/neoantigen/HLA_results",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/HLA_results.tsv",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/neoantigen/combined_filtered.tsv'",
                                    "merge_pointer": "/neoantigen/combined_filtered",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/combined_filtered.tsv",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                }
                            ]
                        },
                        "tumor cimac id": {
                            "merge_pointer": "/tumor/cimac_id",
                            "type_ref": "sample.json#properties/cimac_id",
                            "process_as": [
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.sorted.dedup.bam'",
                                    "merge_pointer": "/tumor/alignment/align_sorted_dedup",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/tumor/{tumor cimac id}/sorted.dedup.bam",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.sorted.dedup.bam.bai'",
                                    "merge_pointer": "/tumor/alignment/align_sorted_dedup_index",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/tumor/{tumor cimac id}/sorted.dedup.bam.bai",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/{id}/{id}_coverage_metrics.txt'",
                                    "merge_pointer": "/tumor/metrics/coverage_metrics",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/tumor/{tumor cimac id}/coverage_metrics.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/{id}/{id}_target_metrics.txt'",
                                    "merge_pointer": "/tumor/metrics/target_metrics",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/tumor/{tumor cimac id}/target_metrics.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/{id}/{id}_coverage_metrics.sample_summary.txt'",
                                    "merge_pointer": "/tumor/metrics/coverage_metrics_summary",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/tumor/{tumor cimac id}/coverage_metrics_summary.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/{id}/{id}_target_metrics.sample_summary.txt'",
                                    "merge_pointer": "/tumor/metrics/target_metrics_summary",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/tumor/{tumor cimac id}/target_metrics_summary.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/{id}/{id}.broad.mosdepth.region.dist.txt'",
                                    "merge_pointer": "/tumor/metrics/mosdepth_region_dist_broad",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/tumor/{tumor cimac id}/mosdepth_region_dist_broad.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/{id}/{id}.mda.mosdepth.region.dist.txt'",
                                    "merge_pointer": "/tumor/metrics/mosdepth_region_dist_mda",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/tumor/{tumor cimac id}/mosdepth_region_dist_mda.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/{id}/{id}.mocha.mosdepth.region.dist.txt'",
                                    "merge_pointer": "/tumor/metrics/mosdepth_region_dist_mocha",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/tumor/{tumor cimac id}/mosdepth_region_dist_mocha.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/optitype/{id}/{id}_result.tsv'",
                                    "merge_pointer": "/tumor/optitype/optitype_result",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/tumor/{tumor cimac id}/optitype_result.tsv",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/xhla/{id}/{id}_report-{id}-hla.json'",
                                    "merge_pointer": "/tumor/optitype/xhla_report_hla",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/tumor/{tumor cimac id}/xhla_report_hla.json",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                }
                            ]
                        },
                        "normal cimac id": {
                            "merge_pointer": "/normal/cimac_id",
                            "type_ref": "sample.json#properties/cimac_id",
                            "process_as": [
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.sorted.dedup.bam'",
                                    "merge_pointer": "/normal/alignment/align_sorted_dedup",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/normal/{normal cimac id}/sorted.dedup.bam",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.sorted.dedup.bam.bai'",
                                    "merge_pointer": "/normal/alignment/align_sorted_dedup_index",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/normal/{normal cimac id}/sorted.dedup.bam.bai",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/{id}/{id}_coverage_metrics.txt'",
                                    "merge_pointer": "/normal/metrics/coverage_metrics",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/normal/{normal cimac id}/coverage_metrics.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/{id}/{id}_target_metrics.txt'",
                                    "merge_pointer": "/normal/metrics/target_metrics",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/normal/{normal cimac id}/target_metrics.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/{id}/{id}_coverage_metrics.sample_summary.txt'",
                                    "merge_pointer": "/normal/metrics/coverage_metrics_summary",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/normal/{normal cimac id}/coverage_metrics_summary.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/{id}/{id}_target_metrics.sample_summary.txt'",
                                    "merge_pointer": "/normal/metrics/target_metrics_summary",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/normal/{normal cimac id}/target_metrics_summary.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/{id}/{id}.broad.mosdepth.region.dist.txt'",
                                    "merge_pointer": "/normal/metrics/mosdepth_region_dist_broad",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/normal/{normal cimac id}/mosdepth_region_dist_broad.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/{id}/{id}.mda.mosdepth.region.dist.txt'",
                                    "merge_pointer": "/normal/metrics/mosdepth_region_dist_mda",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/normal/{normal cimac id}/mosdepth_region_dist_mda.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/metrics/{id}/{id}.mocha.mosdepth.region.dist.txt'",
                                    "merge_pointer": "/normal/metrics/mosdepth_region_dist_mocha",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/normal/{normal cimac id}/mosdepth_region_dist_mocha.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/optitype/{id}/{id}_result.tsv'",
                                    "merge_pointer": "/normal/optitype/optitype_result",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/normal/{normal cimac id}/optitype_result.tsv",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/xhla/{id}/{id}_report-{id}-hla.json'",
                                    "merge_pointer": "/normal/optitype/xhla_report_hla",
                                    "gcs_uri_format": "{protocol identifier}/wes/{run id}/analysis/normal/{normal cimac id}/xhla_report_hla.json",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                }
                            ]
                        }
                    }
                }
            }
        }
    }
}
