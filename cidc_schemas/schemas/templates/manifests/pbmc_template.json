{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "pbmc_shipping",
  "title": "Shipping manifest for PBMC samples",
  "type": "object",
  "category": "manifest",
  "description": "Shipping / receiving manifest for transferring PBMC samples.\n",
  "properties": {
    "worksheets": {
      "shipment": {

        "prism_preamble_object_schema" : "clinical_trial.json",
        "prism_preamble_object_pointer" : "/shipments/0",
        "prism_data_object_pointer" : "/shipped",
        
        "preamble_rows": {
          "lead organization study id": {
            "merge_pointer": "2/lead_organization_study_id",
            "type_ref": "clinical_trial.json#properties/lead_organization_study_id"
          },
          "manifest id": {
            "merge_pointer": "/manifest_id",
            "type_ref": "shipping_core.json#properties/manifest_id"
          },
          "request": {
            "merge_pointer": "/request",
            "type_ref": "shipping_core.json#properties/request"
          },
          "assay priority": {
            "merge_pointer": "/assay_priority",
            "type_ref": "shipping_core.json#properties/assay_priority"
          },
          "assay type": {
            "merge_pointer": "/assay_type",
            "type_ref": "shipping_core.json#properties/assay_type"
          },
          "batch number": {
            "merge_pointer": "/batch_number",
            "type_ref": "shipping_core.json#properties/batch_number"
          },
          "box number": {
            "merge_pointer": "/box_number",
            "type_ref": "shipping_core.json#properties/box_number"
          },
          "assay run number": {
            "merge_pointer": "/assay_run_number",
            "type_ref": "shipping_core.json#properties/assay_run_number"
          },
          "courier": {
            "merge_pointer": "/courier",
            "type_ref": "shipping_core.json#properties/courier"
          },
          "tracking number": {
            "merge_pointer": "/tracking_number",
            "type_ref": "shipping_core.json#properties/tracking_number"
          },
          "account number": {
            "merge_pointer": "/account_number",
            "type_ref": "shipping_core.json#properties/account_number"
          },
          "shipping condition": {
            "merge_pointer": "/shipping_condition",
            "type_ref": "shipping_core.json#properties/shipping_condition"
          },
          "date shipped": {
            "merge_pointer": "/date_shipped",
            "type_ref": "shipping_core.json#properties/date_shipped"
          },
          "num of samples shipped": {
            "merge_pointer": "/num_of_samples_shipped",
            "type_ref": "shipping_core.json#properties/num_of_samples_shipped"
          },
          "num of samples good": {
            "merge_pointer": "/num_of_samples_good",
            "type_ref": "shipping_core.json#properties/num_of_samples_good"
          },
          "num of path report": {
            "merge_pointer": "/num_of_path_report",
            "type_ref": "shipping_core.json#properties/num_of_path_report"
          },
          "ship from": {
            "merge_pointer": "/ship_from",
            "type_ref": "shipping_core.json#properties/ship_from"
          },
          "ship to": {
            "merge_pointer": "/ship_to",
            "type_ref": "shipping_core.json#properties/ship_to"
          }
        }
      },
      "aliquots": {

        "prism_preamble_object_schema" : "clinical_trial.json",
        "prism_preamble_object_pointer" : "#",
        "prism_data_object_pointer" : "/participants/0/samples/0",
        
        "data_columns": {
          "Filled by Biorepository": {
            "trial participant id": {
              "merge_pointer": "2/trial_participant_id",
              "type_ref": "participant.json#properties/trial_participant_id"
            },
            "cohort id": {
              "merge_pointer": "2/cohort_id",
              "type_ref": "participant.json#properties/cohort_id" 
            },
            "arm id": {
              "merge_pointer": "2/arm_id",
              "type_ref": "participant.json#properties/arm_id" 
            },
            "site sample id": {
              "merge_pointer": "0/site_sample_id",
              "type_ref": "sample.json#properties/site_sample_id"
            },
            "cimac id": {
              "merge_pointer": "/cimac_id",
              "type_ref": "sample.json#properties/cimac_id",
              "process_as": [{
                "merge_pointer": "2/cimac_participant_id",
                "parse_through": "lambda cimac_id: '-'.join(cimac_id.split('-')[:3])"
              }]
            },
            "time point": {
              "merge_pointer": "0/time_point", 
              "type_ref": "sample.json#properties/time_point" 
            },
            "genomic source": {
              "merge_pointer": "0/genomic_source", 
              "type_ref": "sample.json#properties/genomic_source" 
            },
            "blood collection date": {
              "merge_pointer": "0/blood_collection_date",
              "type_ref": "sample.json#properties/blood_collection_date"
            },
            "blood collection time": {
              "merge_pointer": "0/blood_collection_time",
              "type_ref": "sample.json#properties/blood_collection_time"
            },
            "blood processing date": {
              "merge_pointer": "0/blood_processing_date",
              "type_ref": "sample.json#properties/blood_processing_date"
            },
            "blood processing time": {
              "merge_pointer": "0/blood_processing_time",
              "type_ref": "sample.json#properties/blood_processing_time"
            },
            "sample location": {
              "merge_pointer": "0/sample_location",
              "type_ref": "sample.json#properties/sample_location"
            },
            "specimen type": {
             "merge_pointer": "0/specimen_type", 
             "type_ref": "sample.json#properties/specimen_type" 
            },
            "specimen format": {
              "merge_pointer": "0/specimen_format",
              "type_ref": "sample.json#properties/specimen_format"
            },
            "quantity": {
             "merge_pointer": "/quantity", 
             "type_ref": "aliquot.json#properties/quantity" 
            },
            "volume quantity": {
              "merge_pointer": "/volume_quantity",
              "type_ref": "aliquot.json#properties/volume_quantity"
            },
            "units": {
             "merge_pointer": "/units", 
             "type_ref": "aliquot.json#properties/units" 
            },
            "pbmc aliquoted": {
              "merge_pointer": "/pbmc_aliquoted",
              "type_ref": "aliquot.json#properties/pbmc_aliquoted"
            },
            "sample source": {
             "merge_pointer": "0/sample_source", 
             "type_ref": "sample.json#properties/sample_source" 
            }
          },
          "Filled by CIMAC Lab": {
            "pbmc recovered": {
              "merge_pointer": "/pbmc_recovered",
              "type_ref": "aliquot.json#properties/pbmc_recovered"
            },
            "material used": {
              "merge_pointer": "/material_used",
              "type_ref": "aliquot.json#properties/material_used"
            },
            "material remaining": {
              "merge_pointer": "/material_remaining",
              "type_ref": "aliquot.json#properties/material_remaining"
            },
            "aliquot quality status": {
              "merge_pointer": "/aliquot_quality_status",
              "type_ref": "aliquot.json#properties/aliquot_quality_status"
            },
            "aliquot replacement": {
              "merge_pointer": "/aliquot_replacement",
              "type_ref": "aliquot.json#properties/aliquot_replacement"
            },
            "aliquot status": { 
              "merge_pointer": "/aliquot_status", 
              "type_ref": "aliquot.json#properties/aliquot_status" 
            }
          }
        }
      }
    }
  }
}
