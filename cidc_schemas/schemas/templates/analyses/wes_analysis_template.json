{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "wes_analysis",
    "title": "WES analysis template",
    "type": "object",
    "category": "analysis",
    "description": "Metadata information for WES Analysis output.",
    "prism_template_root_object_schema": "assays/components/ngs/wes_analysis.json",
    "prism_template_root_object_pointer": "/analysis/wes_analysis",
    "properties": {
        "worksheets": {
            "WES Analysis": {
                "preamble_rows": {
                    "protocol identifier": {
                        "merge_pointer": "2/protocol_identifier",
                        "type_ref": "clinical_trial.json#properties/protocol_identifier"
                    }
                },
                "prism_data_object_pointer": "/pair_runs/-",
                "data_columns": {
                    "WES Runs": {
                        "run id": {
                            "merge_pointer": "/run_id",
                            "type_ref": "assays/components/ngs/wes_pair_analysis.json#properties/run_id",
                            "process_as": [
                                {
                                    "parse_through": "lambda run: f'analysis/somatic/{run}/{run}_tnscope.output.vcf'",
                                    "merge_pointer": "/somatic/vcf_tnscope_output",
                                    "gcs_uri_format": "{run id}/wes_analysis/tnscope.output.vcf",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1   
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/somatic/{run}/{run}_tnsnv.output.vcf'",
                                    "merge_pointer": "/somatic/vcf_tnsnv_output",
                                    "gcs_uri_format": "{run id}/wes_analysis/tnsnv.output.vcf",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1   
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/germline/{run}/{run}_vcfcompare.txt'",
                                    "merge_pointer": "/germline/vcf_compare",
                                    "gcs_uri_format": "{run id}/wes_analysis/vcfcompare.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/purity/{run}/{run}.optimalpurityvalue.txt'",
                                    "merge_pointer": "/purity/optimal_purity_value",
                                    "gcs_uri_format": "{run id}/wes_analysis/optimalpurityvalue.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/clonality/{run}/{run}_pyclone.tsv'",
                                    "merge_pointer": "/clonality/clonality_pyclone",
                                    "gcs_uri_format": "{run id}/wes_analysis/clonality_pyclone.tsv",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/copynumber/{run}/{run}_cnvcalls.txt'",
                                    "merge_pointer": "/copynumber/copynumber_cnv_calls",
                                    "gcs_uri_format": "{run id}/wes_analysis/copynumber_cnvcalls.txt",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/copynumber/{run}/{run}_cnvcalls.txt.tn.tsv'",
                                    "merge_pointer": "/copynumber/copynumber_cnv_calls_tsv",
                                    "gcs_uri_format": "{run id}/wes_analysis/copynumber_cnvcalls.txt.tn.tsv",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/neoantigen/{run}/MHC_Class_1/{run}.all_epitopes.tsv'",
                                    "merge_pointer": "/neoantigen/mhc_class_1_epitopes",
                                    "gcs_uri_format": "{run id}/wes_analysis/MHC_Class_1_all_epitopes.tsv",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/neoantigen/{run}/MHC_Class_1/{run}.filtered.condensed.ranked.tsv'",
                                    "merge_pointer": "/neoantigen/mhc_class_1_filtered_condensed_ranked",
                                    "gcs_uri_format": "{run id}/wes_analysis/MHC_Class_1_filtered_condensed_ranked.tsv",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/somatic/{run}/{run}_tnscope.output.vcf'",
                                    "merge_pointer": "/somatic/vcf_tnscope_output",
                                    "gcs_uri_format": "{run id}/wes_analysis/vcf_tnscope_output.vcf",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/somatic/{run}/{run}_tnhaploytper2.output.vcf'",
                                    "merge_pointer": "/somatic/vcf_tnhaploytper2_output",
                                    "gcs_uri_format": "{run id}/wes_analysis/vcf_tnhaploytper2_output.vcf",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda run: f'analysis/somatic/{run}/{run}_tnsnv.output.vcf'",
                                    "merge_pointer": "/somatic/vcf_tnsnv_output",
                                    "gcs_uri_format": "{run id}/wes_analysis/vcf_tnsnv_output.vcf",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                }
                            ]
                        },
                        "tumor cimac id": {
                            "merge_pointer": "/tumor/cimac_id",
                            "type_ref": "sample.json#properties/cimac_id",
                            "process_as": [
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.sorted.bam'",
                                    "merge_pointer": "/tumor/alignment/align_sorted",
                                    "gcs_uri_format": "{run id}/wes_analysis/tumor/{tumor cimac id}/sorted.bam",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.sorted.bai'",
                                    "merge_pointer": "/tumor/alignment/align_sorted_index",
                                    "gcs_uri_format": "{run id}/wes_analysis/tumor/{tumor cimac id}/sorted.bai",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.recalibrated.bam'",
                                    "merge_pointer": "/tumor/alignment/align_recalibrated",
                                    "gcs_uri_format": "{run id}/wes_analysis/tumor/{tumor cimac id}/recalibrated.bam",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.recalibrated.bai'",
                                    "merge_pointer": "/tumor/alignment/align_recalibrated_index",
                                    "gcs_uri_format": "{run id}/wes_analysis/tumor/{tumor cimac id}/recalibrated.bai",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.sorted.dedup.bam'",
                                    "merge_pointer": "/tumor/alignment/align_sorted_dedup",
                                    "gcs_uri_format": "{run id}/wes_analysis/tumor/{tumor cimac id}/sorted.dedup.bam",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.sorted.dedup.bai'",
                                    "merge_pointer": "/tumor/alignment/align_sorted_dedup_index",
                                    "gcs_uri_format": "{run id}/wes_analysis/tumor/{tumor cimac id}/sorted.dedup.bai",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                }
                            ]
                        },
                        "normal cimac id": {
                            "merge_pointer": "/normal/cimac_id",
                            "type_ref": "sample.json#properties/cimac_id",
                            "process_as": [
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.sorted.bam'",
                                    "merge_pointer": "/normal/alignment/align_sorted",
                                    "gcs_uri_format": "{run id}/wes_analysis/normal/{normal cimac id}/sorted.bam",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.sorted.bai'",
                                    "merge_pointer": "/normal/alignment/align_sorted_index",
                                    "gcs_uri_format": "{run id}/wes_analysis/normal/{normal cimac id}/sorted.bai",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.recalibrated.bam'",
                                    "merge_pointer": "/normal/alignment/align_recalibrated",
                                    "gcs_uri_format": "{run id}/wes_analysis/normal/{normal cimac id}/recalibrated.bam",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.recalibrated.bai'",
                                    "merge_pointer": "/normal/alignment/align_recalibrated_index",
                                    "gcs_uri_format": "{run id}/wes_analysis/normal/{normal cimac id}/recalibrated.bai",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.sorted.dedup.bam'",
                                    "merge_pointer": "/normal/alignment/align_sorted_dedup",
                                    "gcs_uri_format": "{run id}/wes_analysis/normal/{normal cimac id}/sorted.dedup.bam",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                },
                                {
                                    "parse_through": "lambda id: f'analysis/align/{id}/{id}.sorted.dedup.bai'",
                                    "merge_pointer": "/normal/alignment/align_sorted_dedup_index",
                                    "gcs_uri_format": "{run id}/wes_analysis/normal/{normal cimac id}/sorted.dedup.bai",
                                    "type_ref": "assays/components/local_file.json#properties/file_path",
                                    "is_artifact": 1
                                }
                            ]
                        }
                    }
                }
            }
        }
    }
}